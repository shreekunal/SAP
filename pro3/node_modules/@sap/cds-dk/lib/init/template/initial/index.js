const { join } = require('path')
const cds = require('../../../cds')
const { mkdirp, path } = cds.utils
const { env4 } = require('../../projectReader')
const { renderAndCopy } = require('../../template')

module.exports = class extends require('../../plugin') {

    async run() {
        const { db, srv, app } = env4('production').folders
        await renderAndCopy(join(__dirname, 'files'), cds.root, { projectName: path.basename(cds.root) })
        await Promise.all([db, srv, app].map(p => mkdirp(p)))
    }

}
